<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Art Therapy Tool</title>

    <!-- Your existing styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="components/sidebar.js"></script>
    <style>
      .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.75);
        z-index: 1000;
        backdrop-filter: blur(3px);
      }

      .modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: var(--background-color);
        padding: 2.5rem;
        border-radius: 12px;
        max-width: 600px;
        width: 90%;
        z-index: 1001;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        border: 1px solid var(--border-color, rgba(0, 0, 0, 0.1));
      }

      /* Light mode specific styles */
      @media (prefers-color-scheme: light) {
        .modal {
          background-color: #ffffff;
          border-color: rgba(0, 0, 0, 0.1);
        }
        
        .modal h2 {
          border-bottom-color: rgba(0, 0, 0, 0.1);
          color: #1a1a1a;
        }

        .modal-content {
          color: #333333;
        }

        .modal-buttons {
          border-top-color: rgba(0, 0, 0, 0.1);
        }
      }

      /* Dark mode specific styles */
      @media (prefers-color-scheme: dark) {
        .modal {
          background-color: #1e1e1e;
          border-color: rgba(255, 255, 255, 0.1);
        }
        
        .modal h2 {
          border-bottom-color: rgba(255, 255, 255, 0.1);
          color: #ffffff;
        }

        .modal-content {
          color: rgba(255, 255, 255, 0.9);
        }

        .modal-buttons {
          border-top-color: rgba(255, 255, 255, 0.1);
        }
      }

      .modal h2 {
        margin-top: 0;
        font-size: 2rem;
        margin-bottom: 1.5rem;
        border-bottom: 1px solid;
        padding-bottom: 0.75rem;
        font-weight: 600;
      }

      .modal-content {
        margin: 1.5rem 0;
        max-height: 300px;
        overflow-y: auto;
        line-height: 1.6;
        font-size: 1.1rem;
      }

      .modal-content p {
        margin-bottom: 1.5rem;
      }

      .modal-content ol {
        padding-left: 1.5rem;
      }

      .modal-content li {
        margin-bottom: 1rem;
      }

      .modal-buttons {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
        margin-top: 2rem;
        padding-top: 1.5rem;
        border-top: 1px solid;
      }

      .modal-button {
        padding: 0.75rem 1.5rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1rem;
        transition: all 0.2s;
        opacity: 0.5;
        pointer-events: none;
      }

      .modal-button.enabled {
        opacity: 1;
        pointer-events: all;
      }

      .modal-button:hover {
        transform: translateY(-1px);
      }

      .modal-button:active {
        transform: translateY(1px);
      }

      .agree-button {
        background-color: #4CAF50;
        color: white;
      }

      .checkbox-container {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .checkbox-container input[type="checkbox"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
      }

      .checkbox-container label {
        cursor: pointer;
        font-size: 1rem;
        user-select: none;
      }

      @media (prefers-color-scheme: light) {
        .checkbox-container label {
          color: #333333;
        }
      }

      @media (prefers-color-scheme: dark) {
        .checkbox-container label {
          color: rgba(255, 255, 255, 0.9);
        }
      }

      /* Scrollbar styling */
      .modal-content::-webkit-scrollbar {
        width: 8px;
      }

      .modal-content::-webkit-scrollbar-track {
        background: transparent;
      }

      .modal-content::-webkit-scrollbar-thumb {
        background-color: var(--border-color, rgba(0, 0, 0, 0.2));
        border-radius: 4px;
      }

      @media (prefers-color-scheme: dark) {
        .modal-content::-webkit-scrollbar-thumb {
          background-color: rgba(255, 255, 255, 0.2);
        }
      }
    </style>
  </head>
  <body>
    <!-- User Agreement Modal -->
    <div id="userAgreementModal" class="modal-overlay">
      <div class="modal">
        <h2>User Agreement</h2>
        <div class="modal-content">
          <p>Welcome to the Art Therapy Tool. Before proceeding, please read and agree to our terms:</p>
          <ol>
            <li>This tool is intended for creative and therapeutic purposes only.</li>
            <li>You acknowledge that the generated content is AI-assisted, and while we strive for quality, results may vary.</li>
            <li>You agree to use this tool responsibly, ensuring compliance with all applicable laws and guidelines.</li>
            <li>
              You understand that some generated content may inadvertently depict sensitive themes. 
              We have safeguards in place to minimize exposure to explicit gore or violence, but you acknowledge the possibility of unintended results and agree to report such instances for review.
            </li>
            <li>We prioritize your privacy and store only the minimal data necessary for the tool's functionality.</li>
          </ol>
        </div>
        <div class="checkbox-container">
          <input type="checkbox" id="agreeCheckbox" onchange="handleCheckbox(this)">
          <label for="agreeCheckbox">I have read and agree to the terms</label>
        </div>
        <div class="modal-buttons">
          <button class="modal-button agree-button" id="agreeButton" onclick="handleAgree()">I Agree</button>
        </div>
      </div>
    </div>

    <div class="theme-toggle">
        <button id="themeToggle" aria-label="Toggle dark mode">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <div class="app-layout">
        <aside class="sidebar-container">
            <art-sidebar></art-sidebar>
        </aside>
        <div class="content-wrapper">
            <main class="main-content centered-content">
                <button class="action-button" onclick="window.location.href='generate.html'">Generate Art</button>
                <button class="action-button">Edit Art</button>
            </main>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/common.js"></script>
    <script src="js/sidebar.js"></script>
    <script>
      // Check if user has already agreed
      function checkUserAgreement() {
        const hasAgreed = localStorage.getItem('userAgreement');
        if (!hasAgreed) {
          document.getElementById('userAgreementModal').style.display = 'block';
          document.body.style.overflow = 'hidden';
        }
      }

      function handleCheckbox(checkbox) {
        const agreeButton = document.getElementById('agreeButton');
        if (checkbox.checked) {
          agreeButton.classList.add('enabled');
        } else {
          agreeButton.classList.remove('enabled');
        }
      }

      function handleAgree() {
        const checkbox = document.getElementById('agreeCheckbox');
        if (!checkbox.checked) return;
        
        localStorage.setItem('userAgreement', 'true');
        document.getElementById('userAgreementModal').style.display = 'none';
        document.body.style.overflow = 'auto';
      }

      // Check agreement status when page loads
      document.addEventListener('DOMContentLoaded', checkUserAgreement);
    </script>
  </body>
</html>
